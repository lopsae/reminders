<!DOCTYPE html>
<meta charset="utf-8">

<style>

svg.chart rect {
  fill: firebrick;
}

svg.chart text.value {
  fill: white;
  font: 10px sans-serif;
  text-anchor: middle;
}

svg.chart text.name {
  fill: firebrick;
  font: 10px sans-serif;
  text-anchor: middle;
}

</style>


<div>
  <svg class="chart"></svg>
</div>


<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

var width = 960, height = 500;

var yScale = d3.scaleLinear()
  .range([height, 0]);

d3.select("svg.chart")
  .attr("width", width)
  .attr("height", height);

d3.tsv("data.tsv")
  .row(parseData)
  .get(displayData);


function parseData(datum) {
  datum.name = datum.letter;
  datum.value = parseFloat(datum.frequency);
  return datum;
}

function displayData(error, data) {
  if (error) {
    console.error("failed to load data file");
    return;
  }

  var maxValue = d3.max(data, function(datum) { return datum.value; });
  yScale.domain([0, maxValue]);

  var barWidth = Math.floor(width/data.length);

  var barContainers = d3.select("svg.chart").selectAll("g")
    .data(data)
    .enter().append("g");

  barContainers
    .attr("transform", function(datum, index) {
      var x = barWidth * index;
      var y = yScale(datum.value);
      return `translate(${x},${y})`;
    });

  barContainers.append("rect")
    .attr("height", function(datum) { return height - yScale(datum.value); })
    .attr("width", barWidth -1);

  barContainers.append("text")
    .attr("class", "value")
    .attr("x", barWidth / 2)
    .attr("y", 3)
    .attr("dy", ".75em")
    .text(function(datum) { return datum.value; })

  barContainers.append("text")
    .attr("class", "name")
    .attr("x", barWidth / 2)
    .attr("dy", "-.25em")
    .text(function(datum) { return datum.name; })
}



</script>

